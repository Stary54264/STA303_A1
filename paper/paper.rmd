---
title: "Analyzing Influencing Factors on Family Size in Portugal"
author: "Jiadong Wang, Yanzun Jiang"
date: "2025-02-03"
thanks: "Code and data supporting this paper is available at: <https://github.com/Stary54264/factors_affect_family_size_in_portugal>"
output: pdf_document
toc: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(here)
library(knitr)
library(gridExtra)
library(patchwork)
library(MASS)
library(glmmTMB)
load(here::here("data/Portugal.RData"))
```

\newpage

# Introduction

Understanding the factors that influence family size is crucial for shaping social and economic policies. In many societies, family size is often linked to cultural and socioeconomic factors such as literacy levels and the age at which individuals marry. Portugal, despite being a European country, had a GDP per capita in 1980 comparable to that of Mexico, making it an interesting case study for fertility patterns. Prior research suggests that rural families tend to have more children than urban families, and birth rates may vary based on educational attainment and marital timing. Building on these findings, our study aims to answer this question: **"How do literacy and age of a marriage affect family size?"**.

Previous studies have shown that higher literacy levels among women are associated with reduced fertility rates due to increased awareness of family planning and career aspirations [@BMC]. Similarly, research on marriage timing suggests that early marriage is linked to larger family sizes due to prolonged reproductive periods [@BMC; @OPHJ]. Comparative studies in China and India further indicate that shifting social norms and economic conditions play a crucial role in fertility decisions [@SJ]. These findings highlight the importance of investigating how these variables interact within the Portuguese context.

To analyze this relationship, we will use Generalized Linear Models (GLMs) as they are well-suited for count data like family size. Specifically, Poisson regression or negative binomial regression will be considered based on the presence of overdispersion. Exploratory data analysis will be conducted to summarize key variables, followed by model selection techniques to identify the best-fitting statistical model. R [@r] will be used to conduct this, and packages including `tidyverse` [@tidyverse], `here` [@here], `knitr` [@knitr], `kableExtra` [@kableExtra], `patchwork` [@patchwork], `xMASS` [@MASS], and `glmmTMB` [@glmmTMB] will also be used. The final model will be interpreted and draw meaningful conclusions about the relationship between literacy, age at marriage, and family size in Portugal.

# Methods

To investigate the relationship between literacy, age at marriage, and family size, we will employ Generalized Linear Models (GLMs), specifically Poisson or negative binomial regression models. Childbirth follows the Poisson process, which assumes that events occur independently and at a constant rate over time, and this makes Poisson distribution an appropriate choice for the data. However, if the data exhibit overdispersion (the variance is significantly greater than the mean), a negative binomial regression model may be considered, as it introduces a dispersion parameter to allow for greater variability.

The primary predictor variables of interest are literacy and age at marriage, as they might influence family size. Interaction effects will also be considered to assess whether the relationship between literacy and family size depends on marital age. These variables are relevant since prior research suggests that rural families tend to have more children, and economic conditions may influence both literacy levels and marriage timing.

The significance of predictors will be determined using hypothesis tests and t-tests on coefficients, with p-values and confidence intervals providing statistical evidence. By conducting an ANOVA test, both explained and unexplained variations would be determined.

# Results

```{r}
#| label: tbl-summarize
#| tbl-cap: "1"
#| echo: false

kable(portugal |>
        summarize(Mean = round(mean(children), 1),
                  SD = round(sd(children), 1),
                  Median = median(children),
                  Minimum = min(children),
                  Maximum = max(children),
                  IQR = round(IQR(children), 1)))

kable(portugal |>
        count(literacy) |>
        rename("Literacy Status" = literacy, "Count" = n))

kable(portugal |>
        count(ageMarried) |>
        rename("Age at Marriage" = ageMarried, "Count" = n))

grid.arrange(table1, table2, table3, ncol = 2)
```

```{r, fig.pos="H", fig.height=6, fig.width=8}
#| label: fig-bar
#| fig-cap: "Overview of key demographic variables: number of children in a family, literacy status, and age at marriage. The left panel (blue) displays the distribution of the number of children per family, showing a right-skewed pattern where most families have fewer children, with the highest frequency at 1 to 3 children. The top-right panel (green) represents literacy status, categorized as 'yes' (literate) or 'no' (illiterate). The majority of individuals are literate, with a much smaller proportion classified as illiterate. The bottom-right panel (red) illustrates the distribution of age at marriage, indicating that the most common age range for marriage is 22 to 25 years, followed by 20 to 22 and 25 to 30 years. Fewer individuals marry at very young (0 to 15, 15 to 18) or older ages (30 and above). These distributions provide critical context for subsequent Generalized Linear Model (GLM) analysis, as they highlight demographic patterns that may influence relationships between these variables."
#| echo: false

bar1 <- ggplot(portugal, aes(x = children)) +
  geom_bar(fill = "blue", alpha = 0.7) +
  theme_minimal() +
  labs(x = "Age at Marriage (Years)", y = "Number of Individuals")

bar2 <- ggplot(portugal, aes(x = literacy)) +
  geom_bar(fill = "green", alpha = 0.7) +
  theme_minimal() +
  labs(x = "Age at Marriage (Years)", y = "Number of Individuals")

bar3 <- ggplot(portugal, aes(x = ageMarried)) +
  geom_bar(fill = "red", alpha = 0.7) +
  theme_minimal() +
  labs(x = "Age at Marriage (Years)", y = "Number of Individuals")

bar1 + bar2 /bar3
```

# Conclusion

\newpage

# References